<div class="page">
  <div class="page-title">
    <div>
      <h1>Dashboard</h1>
      <div class="subtitle">Os cards respeitam as configurações do usuário selecionado.</div>
    </div>
  </div>

  <div *ngIf="loading" style="display:grid; place-items:center; min-height: 45vh;">
    <mat-spinner diameter="44"></mat-spinner>
  </div>

  <div class="grid" *ngIf="!loading">
    <mat-card class="card" *ngFor="let c of cards">
      <mat-card-content style="display:flex; align-items:flex-start; gap: 12px;">
        <div style="width:42px;height:42px;border-radius:14px;display:grid;place-items:center;background:rgba(255,255,255,0.10);border:1px solid rgba(255,255,255,0.12);">
          <mat-icon>{{c.icon || 'insights'}}</mat-icon>
        </div>

        <div style="min-width:0; flex:1;">
          <div style="display:flex; justify-content:space-between; align-items:flex-start; gap: 10px;">
            <div>
              <div class="muted" style="font-size: 12px; letter-spacing: .02em;">{{c.title}}</div>
              <div style="font-size: 20px; font-weight: 800; letter-spacing:-0.02em; margin-top: 2px;">{{c.value}}</div>
            </div>

            <mat-chip-set *ngIf="settings?.dashboard?.showTrends && c.trendPct !== undefined">
              <mat-chip [ngClass]="trendClass(c.trendPct)">{{ trendLabel(c.trendPct) }}</mat-chip>
            </mat-chip-set>
          </div>

          <div class="muted" style="margin-top: 6px; font-size: 12px;">
            {{c.subtitle || '—'}}
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <style>
    mat-chip.pos { background: rgba(30, 180, 120, 0.20); border: 1px solid rgba(30,180,120,0.35); }
    mat-chip.neg { background: rgba(255, 80, 80, 0.20); border: 1px solid rgba(255,80,80,0.35); }
  </style>
</div>
